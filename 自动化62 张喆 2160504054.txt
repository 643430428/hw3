#数字图像处理第三次作业
	1. 姓名：张
	2. 班级：自动化62
	3. 学号：2160504054
	4. 提交日期：2019/3/19
	
	###1.把附件图像的直方图画出；
		
	采用imhist函数和自己编写的程序求取图像的直方图。由每组中两幅图像对比可知，用两个程序的得到的图像直方图对于原始图像是
基本一致，验证了自己编写的程序的正确性。但对于处理后的图像（如test1.bmp等）得到的直方图却不相同，分析原因是因为MATLAB中imhist
会自动把colormap进行线性扩展，导致结果的不同。同时，也注意到imhist函数并没有将统计的灰度值出现的次数除以像素点的总数，造成
两幅直方图的坐标略有不同。将直方图与原始图像对比可以清楚的看到图像的灰度分布与图像直方图之间的关系：在暗图像中，直方图的分量
集中在灰度级的低端；亮图像的直方图分量则倾向于灰度级的高端。低对比度图像具有较窄的直方图，且集中于灰度级的中部；高对比度图像
中直方图的分量覆盖了很宽的灰度级范围，而且像素的分布没有太不均匀。
	###2.把所有图像进行直方图均衡；输出均衡后的图像和源图像进行比对；分析改善内容；
	直方图均衡的公式为
	直方图均衡化的过程：
列出原始图像和变换后图像的灰度级（L是灰度级的个数）；统计员图像中各灰度级的像素个数；计算原始图像直方图P(i)=Ni/N；
计算累计直方图P(j)=P(1) + P(2) + P(3) +…+ P(i)；利用灰度值变换函数计算变换后的灰度值，并四舍五入取整；j=INT[(L-1)Pj+0.5]
确定灰度变换关系i→j，据此将原图像的灰度值f（m,n）=i修正为g（m，n）=j；统计变换后个灰度级的像素个数Nj；
计算变换后图像的直方图Pj=Nj/N；经过处理得到若干组每组四幅图像，每组中四幅图像分别为原始图像、直方图均衡化后的图像、原始图像的直方图以及均衡化后图像的直方图。从直方图上可以观察到灰度分布确实更加均匀并且占据整个灰度级范围；从图像上可以观察到，图像对比的变大，灰度色调变化范围加大。同时，也注意到有些图像的均衡效果不是很好。直方图均衡并不是适用于所有的图像，需要分情况处理。直观上，可以得出这样的结论：若一幅图像的像素倾向于占据整个可能的灰度级并且分布均匀，则该图像会有高对比度的外观并展示灰色调的较大变化。最终效果将是一幅灰度细节丰富且动态范围较大的图像。
	***
	###3.进一步把图像按照对源图像直方图的观察，各自自行指定不同源图像的直方图，进行直方图匹配，进行图像增强；
	 直方图匹配（histogram matching）：将图像直方图以标准图像的直方图为标准作变换,使两图像的直方图相同和近似,从而使两幅
      图像具有类似的色调和反差。
    直方图匹配的原理：对两个直方图都做均衡化，变成相同的归一化的均匀直方图，以此均匀直方图为媒介，再对参考图像做均衡化的逆运算。
　　总共有以下几步：
　　1.求给定的函数的累积直方图s。
　　2.求原图像的累积直方图G。
　　3.求s中每一个值在G中距离最小的位置index。
　　4.求原图像每个像素通过index映射到的新像素的值。
MATLAB函数：功能：直方图匹配。用法： J = histeq(I,hgram)  
  将原始图像I的直方图变成用户指定的向量hgram。hgram中的各元素的值域为[0,1]。
  J = histeq(I,n) 
  指定直方图均衡后的灰度级数n，默认值为64。
  [J,T] = histeq(I,...)  
  返回从能将图像I的灰度直方图变换成图像J的直方图变换T。    
	***
	###4.对elain和lena图像进行7*7的局部直方图增强；
	（4）
    对比原始图像的直方图、匹配图的直方图以及增强后图像的直方图可知，程序基本达到了直方图匹配的要求。但也注意到：
原始图像直方图和匹配后图像的直方图并没有完全一致。分析原因：原因一离散量的舍入误差；原因二原始图像中多个灰度值
映射到增强后图像的同一个灰度值，即多对一的映射导致。对比原始图像以及增强后的图像可知，经过直方图后，大部分图像
的效果得到了一定的改善。但也注意到有些图像的效果非但没有改善反而变差了，可能是因为要求匹配的直方图选择不合适导
致的或者是要求进行直方图匹配的图像的直方图灰度值分布过于集中。有些图像匹配后的直方图与被匹配的直方图比较会发现
存在“截断”现象，此问题一直不知道是什么原因以及如何解决。同时发现，MATLAB中函数imshow函数会自动的将colorm
ap进行插值扩展，导致显示的图像与原始图像不同，解决的方法是将读入的colormap后补0直到补满255个三原色数据为止；
或者直接利用imwrite将图像写成文件的形式，得到的结果也是正确的。
	***
	###5.利用直方图对图像elain和woman进行分割；
	直方图分割的阈值方法的原理是，如果图像所包括的背景区域与所分的目标区域大小可比，而且两者在灰度上有着明
显的去表，那么这样的图像的灰度上有着明显的去表，那么这样的图像的灰度直方图就会呈现很明显的双峰状；其中一个峰值对
应的应该是背景区域的灰度；而另一个峰值对应的就是目标灰度了；理想中的图像的灰度直方图，其背景灰度和目标灰度应对应
两个不同过的灰度峰值，所以选取位于两峰之间的谷值作为阈值，就很快地将一副图像的背景与目标分割开了。经典的直方图算
法实现简单，但是这只是针对少数不同类别的物体彼此灰度相差很大时，才能进行有效的分割。当原始图像的双峰不明显时，分
割得不到理想的图像。先对图像进行锐化或者平滑处理，使之达到改善图像的质量的实际应用的要求，这个方法是当图像的边缘
细节与图像商上梯度的整体强度有关，图像边缘越强，图像的细节效果越明显。
	
	***
	参考文献：
	- 数字图像处理（第三版）冈萨雷斯
	
